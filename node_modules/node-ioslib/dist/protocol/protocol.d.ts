/// <reference types="node" />
import * as net from 'net';
export declare type ProtocolReaderCallback = (resp: any, err?: Error) => void;
export declare class ProtocolReaderFactory<T> {
    private ProtocolReader;
    constructor(ProtocolReader: {
        new (callback: ProtocolReaderCallback): T;
    });
    create(callback: (resp: any, err?: Error) => void): T;
}
export declare abstract class ProtocolReader {
    private headerSize;
    protected callback: ProtocolReaderCallback;
    private body;
    private bodyLength;
    private buffer;
    constructor(headerSize: number, callback: ProtocolReaderCallback);
    /** Returns length of body, or -1 if header doesn't contain length */
    protected abstract parseHeader(data: Buffer): number;
    protected abstract parseBody(data: Buffer): any;
    onData(data?: Buffer): void;
}
export declare abstract class PlistProtocolReader extends ProtocolReader {
    protected parseBody(body: Buffer): any;
}
export interface ProtocolWriter {
    write(sock: net.Socket, msg: any): void;
}
export declare abstract class ProtocolClient<MessageType = any> {
    socket: net.Socket;
    protected readerFactory: ProtocolReaderFactory<ProtocolReader>;
    protected writer: ProtocolWriter;
    constructor(socket: net.Socket, readerFactory: ProtocolReaderFactory<ProtocolReader>, writer: ProtocolWriter);
    sendMessage<ResponseType = any>(msg: MessageType): Promise<ResponseType>;
    sendMessage<CallbackType = void, ResponseType = any>(msg: MessageType, callback: (response: ResponseType, resolve: any, reject: any) => void): Promise<CallbackType>;
}
